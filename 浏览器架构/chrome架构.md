# chrome架构

## 前言

### 进程和线程

- 并行和并发
- 线程

	- 线程不能单独存在，由进程启动和管理

- 进程

	- 一个程序的运行实例

		- 启动一个程序的时候，操作系统会为该程序创建一块内存，用来存放代码、运行中的数据和一个执行任务的主线程

## 单进程浏览器时代

### 浏览器的所有功能模块都是运行在同一个进程里

### 出现的问题

- 1. 不稳定

	- 插件或者复杂js的执行都会导致浏览器的崩溃

- 2. 不流畅

	- 页面渲染、页面展现、js执行、插件等都是运行在一个线程

- 3. 不安全

	- 插件是由C/C++编写，通过插件可以任意获取操作系统的资源
	- 页面脚本可以通过浏览器的漏洞来获取操作系统的权限

## 多进程浏览器时代

### 组成

- 1个浏览器主进程

	- 界面显示、用户交互、子进程管理、同时提供存储功能

- 1个GPU进程

	- 实现3D css的效果

- 1个网络进程

	- 网络资源加载

- 多个渲染进程

	- 核心任务是将HTML、CSS、JS转换为用户可与之交互的网页。默认情况下，chrome会为每一个tab标签页创建一个渲染进程。渲染进程都是运行在沙箱模式下
	- 排版引擎Blink和V8都运行在该进程中。
	- 默认情况下，chrome会为每一个tab标签页创建一个渲染进程。
	- 渲染进程都是运行在沙箱模式下。

		- 沙箱模式下，不能读写硬盘数据，不能获取操作系统权限。

- 多个插件进程

	- 负责插件的运行，插件易崩溃

### 打开一个页面，会有4个进程，分别是一个浏览器进程、渲染进程、网络进程、GPU进程

### 问题

- 1. 更高的资源占用

	- 每个进程都会包含公共基础结构的副本（JS运行环境）

- 2.  更复杂的体系架构

## 面向服务的架构

### 原来的各种模块会被重构成独立的服务（Service），每个服务（Service）都可以在独立的进程中运行，访问服务（Service）必须使用定义好的接口，通过 IPC 来通信，从而构建一个更内聚、松耦合、易于维护和扩展的系统，更好实现 Chrome 简单、稳定、高速、安全的目标

*XMind: ZEN - Trial Version*